<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>Modbus</title>
    <link href="dox.css" rel="stylesheet" type="text/css">
  </head>
<body>
<!-- Generated by Doxygen 1.8.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__modbus.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Modbus</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga0e6d79d4ff38dbf7d3fd81a80d655b70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga0e6d79d4ff38dbf7d3fd81a80d655b70">MB_TCP_PORT_USE_DEFAULT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga0e6d79d4ff38dbf7d3fd81a80d655b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga462d0d9396f02be6f9fd5b6f19463e61"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga462d0d9396f02be6f9fd5b6f19463e61">eMBMode</a> { <a class="el" href="group__modbus.html#gga462d0d9396f02be6f9fd5b6f19463e61a1b807b8cf3d593d8cd8d1a1d21a3da31">MB_RTU</a>, 
<a class="el" href="group__modbus.html#gga462d0d9396f02be6f9fd5b6f19463e61afa37751530d5e48cb5a3f8841f9e3143">MB_ASCII</a>, 
<a class="el" href="group__modbus.html#gga462d0d9396f02be6f9fd5b6f19463e61a5786284fe284b4a23889bf5b444d5142">MB_TCP</a>
 }</td></tr>
<tr class="separator:ga462d0d9396f02be6f9fd5b6f19463e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1398cbbeb317b1dbd0276b275f5b0f8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gaf1398cbbeb317b1dbd0276b275f5b0f8">eMBRegisterMode</a> { <a class="el" href="group__modbus.html#ggaf1398cbbeb317b1dbd0276b275f5b0f8aa210c1d03e2745efb42486b822740d4b">MB_REG_READ</a>, 
<a class="el" href="group__modbus.html#ggaf1398cbbeb317b1dbd0276b275f5b0f8a3d0a62208562b69c5e7692a5a168c14e">MB_REG_WRITE</a>
 }</td></tr>
<tr class="separator:gaf1398cbbeb317b1dbd0276b275f5b0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e7fce8c431cb0e521c67f7f36dd823d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> { <br />
&#160;&#160;<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823dabf4c1fb8c72eafc08be972225613fe2b">MB_ENOERR</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823daf415371aad180c545b726d39adbf9ba7">MB_ENOREG</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823dafa57cdb3f85e8ab4baf160579104d624">MB_EINVAL</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823da539fb138411468b12c05556157c6864d">MB_EPORTERR</a>, 
<br />
&#160;&#160;<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823daf0700c1e37bfc75068e6577bc0b04bb8">MB_ENORES</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823daf6eed4a1c490af14b7467be1e6e2fe67">MB_EIO</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823daf0e64a209ac1a01935167c6986338a6f">MB_EILLSTATE</a>, 
<a class="el" href="group__modbus.html#gga9e7fce8c431cb0e521c67f7f36dd823da017c559e956f718cf77aafe269f49bd5">MB_ETIMEDOUT</a>
<br />
 }</td></tr>
<tr class="separator:ga9e7fce8c431cb0e521c67f7f36dd823d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16ba85fa56bcd52a11a12576af445ccb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga16ba85fa56bcd52a11a12576af445ccb">eMBParity</a> { <a class="el" href="group__modbus.html#gga16ba85fa56bcd52a11a12576af445ccba36c1b70b68bc05d618632e3f975a557b">MB_PAR_NONE</a>, 
<a class="el" href="group__modbus.html#gga16ba85fa56bcd52a11a12576af445ccba955fa6c30334314739ddceed6e749316">MB_PAR_ODD</a>, 
<a class="el" href="group__modbus.html#gga16ba85fa56bcd52a11a12576af445ccba0415f4c7ede57e13a0cca698a8375dbd">MB_PAR_EVEN</a>
 }</td></tr>
<tr class="separator:ga16ba85fa56bcd52a11a12576af445ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga622dbe6b38ff1d255523d4736fa3da26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga622dbe6b38ff1d255523d4736fa3da26">eMBInit</a> (<a class="el" href="group__modbus.html#ga462d0d9396f02be6f9fd5b6f19463e61">eMBMode</a> eMode, UCHAR ucSlaveAddress, UCHAR ucPort, ULONG ulBaudRate, <a class="el" href="group__modbus.html#ga16ba85fa56bcd52a11a12576af445ccb">eMBParity</a> eParity)</td></tr>
<tr class="separator:ga622dbe6b38ff1d255523d4736fa3da26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab06a2d0ef8bdfd866cd934f0ec7e7a6e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gab06a2d0ef8bdfd866cd934f0ec7e7a6e">eMBTCPInit</a> (USHORT usTCPPort)</td></tr>
<tr class="separator:gab06a2d0ef8bdfd866cd934f0ec7e7a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac20080d92be2934456e2a5d27cd36310"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gac20080d92be2934456e2a5d27cd36310">eMBClose</a> (void)</td></tr>
<tr class="separator:gac20080d92be2934456e2a5d27cd36310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab697be370833d562e6b016626d996132"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gab697be370833d562e6b016626d996132">eMBEnable</a> (void)</td></tr>
<tr class="separator:gab697be370833d562e6b016626d996132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcc2a31ec41fc276ab3c3ac705defdf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gabcc2a31ec41fc276ab3c3ac705defdf3">eMBDisable</a> (void)</td></tr>
<tr class="separator:gabcc2a31ec41fc276ab3c3ac705defdf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12648c98d45f768ba878fbcee46caca5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga12648c98d45f768ba878fbcee46caca5">eMBPoll</a> (void)</td></tr>
<tr class="separator:ga12648c98d45f768ba878fbcee46caca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe2b0e2dccf23d506666aa3cfdf6a8a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#gabe2b0e2dccf23d506666aa3cfdf6a8a3">eMBSetSlaveID</a> (UCHAR ucSlaveID, BOOL xIsRunning, UCHAR const *pucAdditional, USHORT usAdditionalLen)</td></tr>
<tr class="separator:gabe2b0e2dccf23d506666aa3cfdf6a8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f6e66893b2388a602ac453253a00784"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modbus.html#ga5f6e66893b2388a602ac453253a00784">eMBRegisterCB</a> (UCHAR ucFunctionCode, pxMBFunctionHandler pxHandler)</td></tr>
<tr class="separator:ga5f6e66893b2388a602ac453253a00784"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;mb.h&quot;</span> </div>
</div><!-- fragment --><p>This module defines the interface for the application. It contains the basic functions and types required to use the Modbus protocol stack. A typical application will want to call <a class="el" href="group__modbus.html#ga622dbe6b38ff1d255523d4736fa3da26" title="Initialize the Modbus protocol stack. ">eMBInit()</a> first. If the device is ready to answer network requests it must then call <a class="el" href="group__modbus.html#gab697be370833d562e6b016626d996132" title="Enable the Modbus protocol stack. ">eMBEnable()</a> to activate the protocol stack. In the main loop the function <a class="el" href="group__modbus.html#ga12648c98d45f768ba878fbcee46caca5" title="The main pooling loop of the Modbus protocol stack. ">eMBPoll()</a> must be called periodically. The time interval between pooling depends on the configured Modbus timeout. If an RTOS is available a separate task should be created and the task should always call the function <a class="el" href="group__modbus.html#ga12648c98d45f768ba878fbcee46caca5" title="The main pooling loop of the Modbus protocol stack. ">eMBPoll()</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// Initialize protocol stack in RTU mode for a slave with address 10 = 0x0A</span></div>
<div class="line"><a class="code" href="group__modbus.html#ga622dbe6b38ff1d255523d4736fa3da26">eMBInit</a>( <a class="code" href="group__modbus.html#gga462d0d9396f02be6f9fd5b6f19463e61a1b807b8cf3d593d8cd8d1a1d21a3da31">MB_RTU</a>, 0x0A, 38400, <a class="code" href="group__modbus.html#gga16ba85fa56bcd52a11a12576af445ccba0415f4c7ede57e13a0cca698a8375dbd">MB_PAR_EVEN</a> );</div>
<div class="line"><span class="comment">// Enable the Modbus Protocol Stack.</span></div>
<div class="line"><a class="code" href="group__modbus.html#gab697be370833d562e6b016626d996132">eMBEnable</a>(  );</div>
<div class="line"><span class="keywordflow">for</span>( ;; )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Call the main polling loop of the Modbus protocol stack.</span></div>
<div class="line">    <a class="code" href="group__modbus.html#ga12648c98d45f768ba878fbcee46caca5">eMBPoll</a>(  );</div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --> <h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga0e6d79d4ff38dbf7d3fd81a80d655b70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MB_TCP_PORT_USE_DEFAULT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use the default Modbus TCP port (502) </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="MCF5235TCP_2demo_8c-example.html#a1">MCF5235TCP/demo.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a1">STR71XTCP/demo.c</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a1">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga9e7fce8c431cb0e521c67f7f36dd823d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Errorcodes used by all function in the protocol stack. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823dabf4c1fb8c72eafc08be972225613fe2b"></a>MB_ENOERR&#160;</td><td class="fielddoc">
<p>no error. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823daf415371aad180c545b726d39adbf9ba7"></a>MB_ENOREG&#160;</td><td class="fielddoc">
<p>illegal register address. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823dafa57cdb3f85e8ab4baf160579104d624"></a>MB_EINVAL&#160;</td><td class="fielddoc">
<p>illegal argument. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823da539fb138411468b12c05556157c6864d"></a>MB_EPORTERR&#160;</td><td class="fielddoc">
<p>porting layer error. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823daf0700c1e37bfc75068e6577bc0b04bb8"></a>MB_ENORES&#160;</td><td class="fielddoc">
<p>insufficient resources. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823daf6eed4a1c490af14b7467be1e6e2fe67"></a>MB_EIO&#160;</td><td class="fielddoc">
<p>I/O error. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823daf0e64a209ac1a01935167c6986338a6f"></a>MB_EILLSTATE&#160;</td><td class="fielddoc">
<p>protocol stack in illegal state. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9e7fce8c431cb0e521c67f7f36dd823da017c559e956f718cf77aafe269f49bd5"></a>MB_ETIMEDOUT&#160;</td><td class="fielddoc">
<p>timeout error occurred. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="ga462d0d9396f02be6f9fd5b6f19463e61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__modbus.html#ga462d0d9396f02be6f9fd5b6f19463e61">eMBMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modbus serial transmission modes (RTU/ASCII). </p>
<p>Modbus serial supports two transmission modes. Either ASCII or RTU. RTU is faster but has more hardware requirements and requires a network with a low jitter. ASCII is slower and more reliable on slower links (E.g. modems) </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga462d0d9396f02be6f9fd5b6f19463e61a1b807b8cf3d593d8cd8d1a1d21a3da31"></a>MB_RTU&#160;</td><td class="fielddoc">
<p>RTU transmission mode. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga462d0d9396f02be6f9fd5b6f19463e61afa37751530d5e48cb5a3f8841f9e3143"></a>MB_ASCII&#160;</td><td class="fielddoc">
<p>ASCII transmission mode. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga462d0d9396f02be6f9fd5b6f19463e61a5786284fe284b4a23889bf5b444d5142"></a>MB_TCP&#160;</td><td class="fielddoc">
<p>TCP mode. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="ga16ba85fa56bcd52a11a12576af445ccb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__modbus.html#ga16ba85fa56bcd52a11a12576af445ccb">eMBParity</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parity used for characters in serial mode. </p>
<p>The parity which should be applied to the characters sent over the serial link. Please note that this values are actually passed to the porting layer and therefore not all parity modes might be available. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga16ba85fa56bcd52a11a12576af445ccba36c1b70b68bc05d618632e3f975a557b"></a>MB_PAR_NONE&#160;</td><td class="fielddoc">
<p>No parity. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga16ba85fa56bcd52a11a12576af445ccba955fa6c30334314739ddceed6e749316"></a>MB_PAR_ODD&#160;</td><td class="fielddoc">
<p>Odd parity. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga16ba85fa56bcd52a11a12576af445ccba0415f4c7ede57e13a0cca698a8375dbd"></a>MB_PAR_EVEN&#160;</td><td class="fielddoc">
<p>Even parity. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="gaf1398cbbeb317b1dbd0276b275f5b0f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__modbus.html#gaf1398cbbeb317b1dbd0276b275f5b0f8">eMBRegisterMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If register should be written or read. </p>
<p>This value is passed to the callback functions which support either reading or writing register values. Writing means that the application registers should be updated and reading means that the modbus protocol stack needs to know the current register values.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__modbus__registers.html#ga10d37e1d80224bf3b1eeb9e246d7582e" title="Callback function used if a Holding Register value is read or written by the protocol stack...">eMBRegHoldingCB( )</a>, <a class="el" href="group__modbus__registers.html#ga88d9b719291515c60eee1bf9ffa1dd02" title="Callback function used if a Coil Register value is read or written by the protocol stack...">eMBRegCoilsCB( )</a>, <a class="el" href="group__modbus__registers.html#ga38101f5da54af137e210a3b8b9fa3887" title="Callback function used if a Input Discrete Register value is read by the protocol stack...">eMBRegDiscreteCB( )</a> and <a class="el" href="group__modbus__registers.html#ga7816677520b1eb2ebecf15060a41bc81" title="Callback function used if the value of a Input Register is required by the protocol stack...">eMBRegInputCB( )</a>. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ggaf1398cbbeb317b1dbd0276b275f5b0f8aa210c1d03e2745efb42486b822740d4b"></a>MB_REG_READ&#160;</td><td class="fielddoc">
<p>Read register values and pass to protocol stack. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaf1398cbbeb317b1dbd0276b275f5b0f8a3d0a62208562b69c5e7692a5a168c14e"></a>MB_REG_WRITE&#160;</td><td class="fielddoc">
<p>Update register values. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gac20080d92be2934456e2a5d27cd36310"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBClose </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release resources used by the protocol stack. </p>
<p>This function disables the Modbus protocol stack and release all hardware resources. It must only be called when the protocol stack is disabled.</p>
<dl class="section note"><dt>Note</dt><dd>Note all ports implement this function. A port which wants to get an callback must define the macro MB_PORT_HAS_CLOSE to 1.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>If the resources where released it return eMBErrorCode::MB_ENOERR. If the protocol stack is not in the disabled state it returns eMBErrorCode::MB_EILLSTATE. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="LINUX_2demo_8c-example.html#a5">LINUX/demo.c</a>, <a class="el" href="MCF5235TCP_2demo_8c-example.html#a6">MCF5235TCP/demo.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a6">STR71XTCP/demo.c</a>, <a class="el" href="WIN32_2demo_8cpp-example.html#a5">WIN32/demo.cpp</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a3">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gabcc2a31ec41fc276ab3c3ac705defdf3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBDisable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable the Modbus protocol stack. </p>
<p>This function disables processing of Modbus frames.</p>
<dl class="section return"><dt>Returns</dt><dd>If the protocol stack has been disabled it returns eMBErrorCode::MB_ENOERR. If it was not in the enabled state it returns eMBErrorCode::MB_EILLSTATE. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="LINUX_2demo_8c-example.html#a8">LINUX/demo.c</a>, <a class="el" href="MCF5235TCP_2demo_8c-example.html#a5">MCF5235TCP/demo.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a5">STR71XTCP/demo.c</a>, <a class="el" href="WIN32_2demo_8cpp-example.html#a8">WIN32/demo.cpp</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a6">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gab697be370833d562e6b016626d996132"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBEnable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable the Modbus protocol stack. </p>
<p>This function enables processing of Modbus frames. Enabling the protocol stack is only possible if it is in the disabled state.</p>
<dl class="section return"><dt>Returns</dt><dd>If the protocol stack is now in the state enabled it returns eMBErrorCode::MB_ENOERR. If it was not in the disabled state it return eMBErrorCode::MB_EILLSTATE. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="AT91SAM7X_ROWLEY_2demo_8c-example.html#a3">AT91SAM7X_ROWLEY/demo.c</a>, <a class="el" href="AVR_2demo_8c-example.html#a4">AVR/demo.c</a>, <a class="el" href="LINUX_2demo_8c-example.html#a6">LINUX/demo.c</a>, <a class="el" href="MCF5235_2demo_8c-example.html#a4">MCF5235/demo.c</a>, <a class="el" href="MCF5235TCP_2demo_8c-example.html#a3">MCF5235TCP/demo.c</a>, <a class="el" href="MSP430_2demo_8c-example.html#a4">MSP430/demo.c</a>, <a class="el" href="STR71X_2simple2_8c-example.html#a3">STR71X/simple2.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a3">STR71XTCP/demo.c</a>, <a class="el" href="WIN32_2demo_8cpp-example.html#a6">WIN32/demo.cpp</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a4">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga622dbe6b38ff1d255523d4736fa3da26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__modbus.html#ga462d0d9396f02be6f9fd5b6f19463e61">eMBMode</a>&#160;</td>
          <td class="paramname"><em>eMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UCHAR&#160;</td>
          <td class="paramname"><em>ucSlaveAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UCHAR&#160;</td>
          <td class="paramname"><em>ucPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG&#160;</td>
          <td class="paramname"><em>ulBaudRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__modbus.html#ga16ba85fa56bcd52a11a12576af445ccb">eMBParity</a>&#160;</td>
          <td class="paramname"><em>eParity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Modbus protocol stack. </p>
<p>This functions initializes the ASCII or RTU module and calls the init functions of the porting layer to prepare the hardware. Please note that the receiver is still disabled and no Modbus frames are processed until <a class="el" href="group__modbus.html#gab697be370833d562e6b016626d996132" title="Enable the Modbus protocol stack. ">eMBEnable( )</a> has been called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eMode</td><td>If ASCII or RTU mode should be used. </td></tr>
    <tr><td class="paramname">ucSlaveAddress</td><td>The slave address. Only frames sent to this address or to the broadcast address are processed. </td></tr>
    <tr><td class="paramname">ucPort</td><td>The port to use. E.g. 1 for COM1 on windows. This value is platform dependent and some ports simply choose to ignore it. </td></tr>
    <tr><td class="paramname">ulBaudRate</td><td>The baudrate. E.g. 19200. Supported baudrates depend on the porting layer. </td></tr>
    <tr><td class="paramname">eParity</td><td>Parity used for serial transmission.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If no error occurs the function returns eMBErrorCode::MB_ENOERR. The protocol is then in the disabled state and ready for activation by calling <a class="el" href="group__modbus.html#gab697be370833d562e6b016626d996132" title="Enable the Modbus protocol stack. ">eMBEnable( )</a>. Otherwise one of the following error codes is returned:<ul>
<li>eMBErrorCode::MB_EINVAL If the slave address was not valid. Valid slave addresses are in the range 1 - 247.</li>
<li>eMBErrorCode::MB_EPORTERR IF the porting layer returned an error. </li>
</ul>
</dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="AT91SAM7X_ROWLEY_2demo_8c-example.html#a0">AT91SAM7X_ROWLEY/demo.c</a>, <a class="el" href="AVR_2demo_8c-example.html#a0">AVR/demo.c</a>, <a class="el" href="LINUX_2demo_8c-example.html#a0">LINUX/demo.c</a>, <a class="el" href="MCF5235_2demo_8c-example.html#a0">MCF5235/demo.c</a>, <a class="el" href="MSP430_2demo_8c-example.html#a0">MSP430/demo.c</a>, <a class="el" href="STR71X_2simple2_8c-example.html#a0">STR71X/simple2.c</a>, and <a class="el" href="WIN32_2demo_8cpp-example.html#a0">WIN32/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga12648c98d45f768ba878fbcee46caca5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBPoll </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main pooling loop of the Modbus protocol stack. </p>
<p>This function must be called periodically. The timer interval required is given by the application dependent Modbus slave timeout. Internally the function calls xMBPortEventGet() and waits for an event from the receiver or transmitter state machines.</p>
<dl class="section return"><dt>Returns</dt><dd>If the protocol stack is not in the enabled state the function returns eMBErrorCode::MB_EILLSTATE. Otherwise it returns eMBErrorCode::MB_ENOERR. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="AT91SAM7X_ROWLEY_2demo_8c-example.html#a4">AT91SAM7X_ROWLEY/demo.c</a>, <a class="el" href="AVR_2demo_8c-example.html#a5">AVR/demo.c</a>, <a class="el" href="LINUX_2demo_8c-example.html#a7">LINUX/demo.c</a>, <a class="el" href="MCF5235_2demo_8c-example.html#a5">MCF5235/demo.c</a>, <a class="el" href="MCF5235TCP_2demo_8c-example.html#a4">MCF5235TCP/demo.c</a>, <a class="el" href="MSP430_2demo_8c-example.html#a5">MSP430/demo.c</a>, <a class="el" href="STR71X_2simple2_8c-example.html#a4">STR71X/simple2.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a4">STR71XTCP/demo.c</a>, <a class="el" href="WIN32_2demo_8cpp-example.html#a7">WIN32/demo.cpp</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a5">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga5f6e66893b2388a602ac453253a00784"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBRegisterCB </td>
          <td>(</td>
          <td class="paramtype">UCHAR&#160;</td>
          <td class="paramname"><em>ucFunctionCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pxMBFunctionHandler&#160;</td>
          <td class="paramname"><em>pxHandler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback handler for a given function code. </p>
<p>This function registers a new callback handler for a given function code. The callback handler supplied is responsible for interpreting the Modbus PDU and the creation of an appropriate response. In case of an error it should return one of the possible Modbus exceptions which results in a Modbus exception frame sent by the protocol stack.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ucFunctionCode</td><td>The Modbus function code for which this handler should be registers. Valid function codes are in the range 1 to 127. </td></tr>
    <tr><td class="paramname">pxHandler</td><td>The function handler which should be called in case such a frame is received. If <code>NULL</code> a previously registered function handler for this function code is removed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>eMBErrorCode::MB_ENOERR if the handler has been installed. If no more resources are available it returns eMBErrorCode::MB_ENORES. In this case the values in mbconfig.h should be adjusted. If the argument was not valid it returns eMBErrorCode::MB_EINVAL. </dd></dl>

</div>
</div>
<a class="anchor" id="gabe2b0e2dccf23d506666aa3cfdf6a8a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBSetSlaveID </td>
          <td>(</td>
          <td class="paramtype">UCHAR&#160;</td>
          <td class="paramname"><em>ucSlaveID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>xIsRunning</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UCHAR const *&#160;</td>
          <td class="paramname"><em>pucAdditional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">USHORT&#160;</td>
          <td class="paramname"><em>usAdditionalLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the slave id of the device. </p>
<p>This function should be called when the Modbus function <em>Report Slave ID</em> is enabled ( By defining MB_FUNC_OTHER_REP_SLAVEID_ENABLED in mbconfig.h ).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ucSlaveID</td><td>Values is returned in the <em>Slave ID</em> byte of the <em>Report Slave ID</em> response. </td></tr>
    <tr><td class="paramname">xIsRunning</td><td>If TRUE the <em>Run Indicator Status</em> byte is set to 0xFF. otherwise the <em>Run Indicator Status</em> is 0x00. </td></tr>
    <tr><td class="paramname">pucAdditional</td><td>Values which should be returned in the <em>Additional</em> bytes of the <em> Report Slave ID</em> response. </td></tr>
    <tr><td class="paramname">usAdditionalLen</td><td>Length of the buffer <code>pucAdditonal</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the static buffer defined by MB_FUNC_OTHER_REP_SLAVEID_BUF in mbconfig.h is to small it returns eMBErrorCode::MB_ENORES. Otherwise it returns eMBErrorCode::MB_ENOERR. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="AVR_2demo_8c-example.html#a3">AVR/demo.c</a>, <a class="el" href="LINUX_2demo_8c-example.html#a4">LINUX/demo.c</a>, <a class="el" href="MCF5235_2demo_8c-example.html#a3">MCF5235/demo.c</a>, and <a class="el" href="WIN32_2demo_8cpp-example.html#a4">WIN32/demo.cpp</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gab06a2d0ef8bdfd866cd934f0ec7e7a6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__modbus.html#ga9e7fce8c431cb0e521c67f7f36dd823d">eMBErrorCode</a> eMBTCPInit </td>
          <td>(</td>
          <td class="paramtype">USHORT&#160;</td>
          <td class="paramname"><em>usTCPPort</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Modbus protocol stack for Modbus TCP. </p>
<p>This function initializes the Modbus TCP Module. Please note that frame processing is still disabled until <a class="el" href="group__modbus.html#gab697be370833d562e6b016626d996132" title="Enable the Modbus protocol stack. ">eMBEnable( )</a> is called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">usTCPPort</td><td>The TCP port to listen on. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the protocol stack has been initialized correctly the function returns eMBErrorCode::MB_ENOERR. Otherwise one of the following error codes is returned:<ul>
<li>eMBErrorCode::MB_EINVAL If the slave address was not valid. Valid slave addresses are in the range 1 - 247.</li>
<li>eMBErrorCode::MB_EPORTERR IF the porting layer returned an error. </li>
</ul>
</dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="MCF5235TCP_2demo_8c-example.html#a0">MCF5235TCP/demo.c</a>, <a class="el" href="STR71XTCP_2demo_8c-example.html#a0">STR71XTCP/demo.c</a>, and <a class="el" href="WIN32TCP_2demo_8cpp-example.html#a0">WIN32TCP/demo.cpp</a>.</dd>
</dl>
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

<hr width="80%">
<p><center>Automatically generated by Doxygen 1.8.9.1 on Mon Oct 9 2017.</center></p>
</body>
</html>
